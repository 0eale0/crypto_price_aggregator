image: python:3.10

stages:
  - lint
  - test


lint:
  stage: lint
  script:
    - pip install poetry==1.1.11
    - poetry config virtualenvs.create false
    - poetry install
    - black . --check --diff

pytest:
  stage: test
  script:
    - pip install pytest pytest-cov
    - coverage run -m pytest
    - coverage report
  coverage: '/TOTAL.*\s([.\d]+)%/'